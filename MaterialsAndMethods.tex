\section*{Materials and Methods}

Basic explanation of the models. We modeled a stage-structured population in two stages: immatures and matures. The demography is given by a transition matrix, with...

From ENGEN ET AL (REF NEEDED), we derived equations for mean variation of phenotype on our model.

We have for variations of phenotype, under weak selection:
\begin{equation}
\Delta\overline{z} = (\theta_{f} - \overline{z}) \left[ \frac{ v_{I} u_{I} G_{I} s_{0} m \overline{f}_{1} }{\lambda(P_{I}+\omega_{f})} + \frac{ v_{I} u_{M} G_{M} s_{0} \overline{f}_{2}} {\lambda ( P_{M} + \omega_{f} )} \right] + (\theta_{s} - \overline{z}) \left[ \frac{ v_{I} u_{I} G_{I} \overline{s}_{I} (1-m) }{\lambda(P_{I}+\omega_{s})} \right]
\end{equation}

Within the square brackets, we see weighting average of fecundity and survival. Thus, we define them as $\gamma_{f}$ and $\gamma_{s}$ such as:

\begin{subequations}
	\begin{align}
	\gamma_{f} = \frac{ v_{I} u_{I} G_{I} s_{0} m \overline{f}_{1} }{\lambda(P_{I}+\omega_{f})} + \frac{ v_{I} u_{M} G_{M} s_{0} \overline{f}_{2}} {\lambda ( P_{M} + \omega_{f} )}
	\end{align}
	and
	\begin{align}
	\gamma_{s} = \frac{ v_{I} u_{I} G_{I} \overline{s}_{I} (1-m) }{\lambda(P_{I}+\omega_{s})}
	\end{align}
\end{subequations}

We supposed an auto-correlated fluctuating environment influencing optimum such as $\theta_{f} = \overline{\theta}}_{f} + \alpha_{f}\epsilon_{t}$. With $\epsilon_{t+1} = (1-\rho)\overline{\epsilon} + \rho\epsilon_{t} + \xi$ with $\xi$ a gaussian noise vector with variance $\sigma^{2}_{\xi}$ and mean $0$.

Using LANDE 2009 (REF NEEDED) we have:
\begin{equation}
	\Delta\overline{z} = \frac{d\log\overline{\lambda}(\overline{z})}{d\overline{z}} = \frac{1}{\overline{\lambda}(\overline{z})} \frac{d\overline{\lambda}(\overline{z})}{d\overline{z}}
\end{equation}