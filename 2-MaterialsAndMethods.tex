\section*{Materials and Methods}

Basic explanation of the models. We modeled a stage-structured population in two stages: immatures and matures. The demography is given by a transition matrix, with...

From \citet{engen_evolution_2011}, we derived equations for mean variation of phenotype on our model.

We have for variations of phenotype, under weak selection:
\begin{equation}
\Delta\overline{z} = (\theta_{f} - \overline{z}) \left[ \frac{ v_{I} u_{I} G_{I} s_{0} m \overline{f}_{1} }{\lambda(P_{I}+\omega_{f})} + \frac{ v_{I} u_{M} G_{M} s_{0} \overline{f}_{2}} {\lambda ( P_{M} + \omega_{f} )} \right] + (\theta_{s} - \overline{z}) \left[ \frac{ v_{I} u_{I} G_{I} \overline{s}_{I} (1-m) }{\lambda(P_{I}+\omega_{s})} \right]
\end{equation}

Within the square brackets, we see weighting average of fecundity and survival. Thus, we define them as $\gamma_{f}$ and $\gamma_{s}$ such as:

\begin{subequations}
	\begin{align}
	\gamma_{f} = \frac{ v_{I} u_{I} G_{I} s_{0} m \overline{f}_{1} }{\lambda(P_{I}+\omega_{f})} + \frac{ v_{I} u_{M} G_{M} s_{0} \overline{f}_{2}} {\lambda ( P_{M} + \omega_{f} )}
	\end{align}
	and
	\begin{align}
	\gamma_{s} = \frac{ v_{I} u_{I} G_{I} \overline{s}_{I} (1-m) }{\lambda(P_{I}+\omega_{s})}
	\end{align}
\end{subequations}

We supposed an auto-correlated fluctuating environment influencing optimum such as $\theta_{f} = \overline{\theta}_{f} + \alpha_{f}\epsilon_{t}$. With $\epsilon_{t+1} = (1-\rho)\overline{\epsilon} + \rho\epsilon_{t} + \xi$ with $\xi$ a gaussian noise vector with variance $\sigma^{2}_{\xi}$ and mean $0$.

Using \citet{lande_adaptation_2009}, under weak selection we have:
\begin{equation}
	\Delta\overline{z} = \frac{d\log\overline{\lambda}(\overline{z})}{d\overline{z}} = \frac{1}{\overline{\lambda}(\overline{z})} \frac{d\overline{\lambda}(\overline{z})}{d\overline{z}}
\end{equation}

And we have:
\begin{align*}
	\overline{\lambda}(\overline{z}) &= \sum_{i,j}{v_{i} u_{j} \overline{a_{ij}}} \\
	&= v_{I} u_{I} \overline{a_{II}} + v_{I} u_{M} \overline{a_{IM}} + v_{M} u_{I} \overline{a_{MI}} + v_{M} u_{M} \overline{a_{MM}}
\end{align*}

with $\overline{a_{ij}}$ the expected values of the coefficent of the transition matrix. Thus,
\begin{align}
	\overline{\lambda}(\overline{z}) = &v_{I} u_{I} \left[ \overline{f_{1}}(\overline{z})m s_{0} + (1-m)\overline{s_{I}}(\overline{z}) \right] \nonumber \\
	&+ v_{I} u_{M} s_0 \overline{f_{2}}(\overline{z})+ v_{M} u_{I} m s_M + v_{M} u_{M} s_M
\end{align}